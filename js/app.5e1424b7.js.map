{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/BasicLayout/CustomPanel/Animate/index.vue?64ea","webpack:///./src/App.vue","webpack:///./src/App.vue?eabf","webpack:///./src/views/Home.vue","webpack:///./src/store/widgets.ts","webpack:///./src/components/BasicLayout/Aside.tsx","webpack:///./src/store/modules/editor.ts","webpack:///./src/store/index.ts","webpack:///./src/uses/propertyBase.ts","webpack:///./src/uses/snapshop.ts","webpack:///./src/components/BasicLayout/CustomPanel/Base.tsx","webpack:///./src/uses/stopClick.ts","webpack:///./src/components/BasicLayout/CustomPanel/Custom.tsx","webpack:///./src/components/BasicLayout/CustomPanel/Animate/index.vue","webpack:///./src/components/BasicLayout/CustomPanel/Animate/effects.ts","webpack:///./src/components/Editor/bus.ts","webpack:///./src/components/BasicLayout/CustomPanel/Animate/index.vue?3885","webpack:///./src/components/BasicLayout/CustomPanel/Animate/index.vue?a150","webpack:///./src/components/BasicLayout/CustomPanel/index.tsx","webpack:///./src/components/BasicLayout/Header.tsx","webpack:///./src/components/BasicLayout/index.tsx","webpack:///./src/components/Editor/Lines/utils.ts","webpack:///./src/utils.ts","webpack:///./src/components/Editor/Lines/index.tsx","webpack:///./src/components/Editor/types.ts","webpack:///./src/components/Editor/Dot/index.tsx","webpack:///./src/components/Editor/stretch.ts","webpack:///./src/components/Editor/Dot/dot.ts","webpack:///./src/components/Editor/RotateDot.tsx","webpack:///./src/components/Editor/Widget.tsx","webpack:///./src/uses/rect.ts","webpack:///./src/components/Editor/index.tsx","webpack:///./src/views/Home.vue?d5e7","webpack:///./src/views/Home.vue?a655","webpack:///./src/router/index.ts","webpack:///./src/plugins/index.ts","webpack:///./src/components/BasicLayout/CustomPanel/Specials/ButtonProperty/index.tsx","webpack:///./src/components/BasicLayout/CustomPanel/Specials/CardProperty/index.tsx","webpack:///./src/components/BasicLayout/CustomPanel/Specials/index.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","id","render","class","ref","WidgetList","component","label","icon","widgetStyle","minSize","width","height","left","top","rotate","opacity","style","borderRadius","props","type","specialPanel","animateClass","shadow","header","setup","handleDragstart","index","event","dataTransfer","setData","toString","widgets","map","item","editor","namespaced","state","activeWidgetId","canvasRect","mutations","setCanvasRect","setActivateWidgetId","addWidget","widget","setLabel","newWidget","target","find","setAnimateClass","cls","setWidgetStyle","setWidgetBaseStyle","setWidgetProps","resetWidgets","actions","isDev","snapshots","currentIndex","getters","currentSnapshot","setSnapshot","shot","setCurrentIndex","Math","max","addSnapshot","commit","newIndex","strict","plugins","useStore","properBase","store","activeWidget","newSnapshot","activeInSnapshotIndex","findIndex","dispatch","delSnapshot","clearSnapshot","saveSnapshot","localStorage","setItem","storageKey","JSON","stringify","emit","fontSize","color","backgroundColor","borderColor","textAlign","specialValue","setStyles","special","cloneWidget","newStyle","keys","forEach","attr","Reflect","has","stopClick","stopPropagation","speed","size","selected","effects","span","Effects","emitter","aniEmitter","filter","toLowerCase","indexOf","preview","currentClass","speedClass","commitCls","classList","remove","add","animate","changeIndex","num","handleDel","handleClear","handleSave","success","message","undefined","slots","default","initLines","getCanvasOffset","rect","vertical","offset","horizontal","show","rotateToRadian","PI","sin","abs","cos","conversionRotateOneCircle","ceil","floor","conversionRotateToQuadrant","Map","set","getCenterPoint","p1","p2","x","y","getRotatedPoint","point","center","getPoint","Direct","dis","Array","canvasOffset","offsetInfo","movingWidgetSize","lines","handlePress","otherWidgets","saveWidgetsOffset","info","calculateWidgetOffset","handleMove","v","lineIndex","nearLine","concat","delta","dom","h","on","isMovingWidget","newWidth","diffX","vl","newHeight","diffY","ht","startsWith","required","emits","startInfo","handleMousedown","clientX","clientY","toggleMoving","handleMouseMove","preventDefault","handleMouseUp","movable","document","addEventListener","removeEventListener","cursor","trueType","stretchN","dotMousedownInfo","currentPosition","root","callback","sPoint","handlePoint","rotatedCurrentPosition","rotatedTopMiddlePoint","sqrt","pow","newCenter","stretchE","rotatedRightMiddlePoint","stretchS","rotatedBottomMiddlePoint","stretchW","rotatedLeftMiddlePoint","stretchNW","newCenterPoint","newTopLeftPoint","newBottomRightPoint","stretchNE","newTopRightPoint","newBottomLeftPoint","stretchSE","stretchSW","stretchStrategy","e","w","nw","ne","se","sw","quadrantDirect","onCoordinate","sx","newRotate","whichQuadrantDirect","calculateDotInfo","originCenter","currentX","currentY","a","b","atan2","dots","moving","isActive","setActive","generateDots","offsetLeft","offsetTop","zIndex","calculate","newLeft","newTop","handleDotDown","handleDotMove","position","handleDotUp","clientWidth","clientHeight","entries","renderDots","Dot","onDown","onMove","onUp","handleRotateDotMove","transform","setAttribute","handleRotateDotUp","dataset","setCls","Boolean","refresh","active","this","className","animate__animated","isWindow","val","elementRef","element","innerWidth","innerHeight","right","bottom","getBoundingClientRect","renderWidgets","handleDragOver","dropEffect","handleDrop","contains","getData","offsetX","offsetY","generateUUID","canvas","Date","getTime","uuid","replace","random","components","BasicLayout","Editor","records","getItem","parse","routes","path","Home","redirect","router","history","use","app","propValues","disable","loading","setProps","prop","setStatus","App","mount"],"mappings":"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","file":"js/app.5e1424b7.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/vue-next-drag/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=02179466&lang=scss\"","<template>\n  <div id=\"app\">\n    <router-view />\n  </div>\n</template>\n\n<script>\n\nexport default {\n  name: 'App'\n}\n</script>\n","import { render } from \"./App.vue?vue&type=template&id=187e221e\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"home\" ref=\"root\">\n    <basic-layout>\n      <editor />\n    </basic-layout>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {defineComponent, onMounted, ref} from 'vue';\nimport BasicLayout from \"../components/BasicLayout\";\nimport Editor from '../components/Editor';\nimport {useStore} from \"../store\";\nimport {storageKey} from \"../main\";\n\nexport default defineComponent({\n  name: 'Home',\n  components: { BasicLayout, Editor },\n  setup() {\n    const root = ref<HTMLElement | null>(null);\n    const store = useStore();\n    const records = localStorage.getItem(storageKey);\n    if (records) {\n      store.dispatch('addSnapshot', JSON.parse(records));\n    }\n    onMounted(() => {\n      if (root.value) {\n        root.value.addEventListener('click', (event: MouseEvent) => {\n          if (store.state.editor.activeWidgetId) {\n            store.commit('editor/setActivateWidgetId', '');\n          }\n        });\n      }\n    });\n    return {\n      root\n    }\n  }\n});\n</script>\n","import {Widget} from \"./types\";\n\nexport const WidgetList: Widget[] = [\n  {\n    component: 'el-button',\n    name: '按钮',\n    label: '按钮',\n    icon: 'el-icon-thumb',\n    widgetStyle: {\n      minSize: {\n        width: 42,\n        height: 26\n      },\n      left: 0,\n      top: 0,\n      width: 70,\n      height: 40,\n      rotate: 0,\n      opacity: 1\n    },\n    style: {\n      borderRadius: '0px',\n      width: '100%',\n      height: '100%'\n    },\n    props: {\n      type: 'primary'\n    },\n    specialPanel: 'button-property',\n    animateClass: {\n      // animate: 'tada',\n      // speed: 'fast'\n    }\n  },\n  {\n    component: 'el-card',\n    name: '卡片',\n    label: '内容',\n    icon: 'el-icon-edit',\n    widgetStyle: {\n      minSize: {\n        width: 42,\n        height: 42\n      },\n      left: 0,\n      top: 0,\n      width: 70,\n      height: 121,\n      rotate: 0,\n      opacity: 1\n    },\n    style: {\n      borderRadius: '0px',\n      width: '100%',\n      height: '100%'\n    },\n    props: {\n      shadow: 'hover',\n      header: '标题'\n    },\n    specialPanel: 'card-property',\n    animateClass: {}\n  }\n];\n","import {defineComponent} from \"vue\";\nimport {WidgetList} from \"../../store/widgets\";\nimport {Widget} from \"../../store/types\";\n\nexport default defineComponent({\n  name: 'Aside',\n  setup(props) {\n    const handleDragstart = (index: number, event: DragEvent) => {\n      event.dataTransfer?.setData('index', index.toString());\n    }\n    const widgets = WidgetList.map((item, index) => {\n      return(\n        <el-card\n          class=\"card\"\n          shadow=\"hover\"\n          draggable=\"true\"\n          onDragstart={ handleDragstart.bind(null, index) }>\n          <i class={item.icon} />\n          <p>{ item.name }</p>\n        </el-card>\n      );\n    });\n    return () => {\n      return (\n        <div class=\"widget-list\">{ widgets }</div>\n      );\n    }\n  }\n})\n","// @ts-ignore\nimport {BaseStyle, Widget, WidgetAnimateClass, WidgetStyle} from \"../types\";\nimport {Module} from \"vuex\";\nimport {RootState} from \"../index\";\n\nexport interface EditorState {\n  widgets: Widget[];\n  activeWidgetId: string;\n  canvasRect: DOMRect | null;\n}\n\nconst editor: Module<EditorState, RootState> = {\n  namespaced: true,\n  state: {\n    widgets: [],\n    activeWidgetId: '',\n    canvasRect: null\n  },\n  mutations: {\n    setCanvasRect(state, canvasRect: DOMRect) {\n      state.canvasRect = canvasRect;\n    },\n    setActivateWidgetId(state, id: string) {\n      state.activeWidgetId = id;\n    },\n    addWidget(state, widget: Widget) {\n      state.widgets.push(widget);\n    },\n    setLabel(state, newWidget: { id: string; label: string}) {\n      const target = state.widgets.find(item => item.id === newWidget.id);\n      if (target) {\n        target.label = newWidget.label;\n      }\n    },\n    setAnimateClass(state, newWidget: { id: string; cls: Partial<WidgetAnimateClass>}) {\n      const target = state.widgets.find(item => item.id === newWidget.id);\n      if (target) {\n        target.animateClass = { ...target.animateClass, ...newWidget.cls };\n      }\n    },\n    setWidgetStyle(state, newWidget: { id: string; value: WidgetStyle }) {\n      const target = state.widgets.find(item => item.id === newWidget.id);\n      if (target) {\n        target.widgetStyle = { ...target.widgetStyle, ...newWidget.value };\n      }\n    },\n    setWidgetBaseStyle(state, newWidget: { id: string, value: BaseStyle }) {\n      const target = state.widgets.find(item => item.id === newWidget.id);\n      if (target) {\n        target.style = { ...target.style, ...newWidget.value };\n      }\n    },\n    setWidgetProps(state, newWidget: { id: string, props: any }) {\n      const target = state.widgets.find(item => item.id === newWidget.id);\n      if (target) {\n        target.props = { ...target.props, ...newWidget.props };\n      }\n    },\n    resetWidgets(state, widgets: Widget[]) {\n      state.widgets = widgets;\n    }\n  },\n  actions: {\n\n  }\n}\n\nexport default editor;\n","import {createStore, createLogger, Store, useStore as baseUseStore, ModuleTree, Module} from 'vuex';\nimport editor, {EditorState} from \"./modules/editor\";\nimport {Widget} from \"./types\";\nimport { InjectionKey } from 'vue';\n\nexport interface RootState {\n  snapshots: Widget[][];\n  currentIndex: number;\n}\n\nexport interface AllStoreType extends RootState {\n  editor: EditorState;\n  // editor: Module<EditorState, RootState>;\n}\n\nconst isDev = process.env.NODE_ENV === 'development';\nexport const key: InjectionKey<Store<AllStoreType>> = Symbol()\nexport const store = createStore<RootState>({\n  modules: { editor },\n  state: {\n    snapshots: [],\n    currentIndex: -1\n  },\n  getters: {\n    currentSnapshot(state) {\n      return state.snapshots[state.currentIndex] || [];\n    }\n  },\n  mutations: {\n    setSnapshot(state, shot: { index: number; widgets: Widget[]; }) {\n      if (shot.index !== state.currentIndex) {\n        state.snapshots.length = state.currentIndex + 1;\n      }\n      state.snapshots.splice(shot.index, 0, shot.widgets);\n    },\n    setCurrentIndex(state, index: number) {\n      state.currentIndex = Math.max(index, -1);\n    }\n  },\n  actions: {\n    addSnapshot({ state, commit }, widgets: Widget[]) {\n      const newIndex = state.currentIndex + 1;\n      commit('setSnapshot', {\n        index: newIndex,\n        widgets\n      });\n      commit('setCurrentIndex', newIndex);\n    }\n  },\n  strict: isDev,\n  plugins: isDev ? [createLogger()] : []\n})\n\nexport function useStore() {\n  return baseUseStore<AllStoreType>(key)\n}\n","import {AllStoreType, useStore} from \"../store\";\nimport {computed} from \"vue\";\nimport {Store} from \"vuex\";\nimport {Widget} from \"../store/types\";\nimport {ComputedRef} from \"@vue/reactivity\";\n\nexport function properBase(): { store: Store<AllStoreType>; widget: ComputedRef<Widget | undefined>; currentSnapshot: ComputedRef<Widget[]> } {\n  const store = useStore();\n  const activeWidget = computed(() => store.state.editor.widgets.find(item => item.id === store.state.editor.activeWidgetId));\n  const currentSnapshot = computed(() => store.getters.currentSnapshot as Widget[]);\n  return { store, widget: activeWidget, currentSnapshot };\n}\n","import {Widget} from \"../store/types\";\nimport {cloneDeep} from \"lodash\";\nimport {Store} from \"vuex\";\nimport {AllStoreType} from \"../store\";\nimport {storageKey} from \"../main\";\n\nexport function setSnapshot(newWidget: Widget, store: Store<AllStoreType>) {\n  const newSnapshot = cloneDeep(store.getters.currentSnapshot as Widget[]);\n  const activeInSnapshotIndex = newSnapshot.findIndex(item => item.id === newWidget.id);\n  // console.log('newSnapshot', newSnapshot, activeInSnapshotIndex);\n  if (activeInSnapshotIndex > -1) {\n    newSnapshot.splice(activeInSnapshotIndex, 1, cloneDeep(newWidget));\n  }\n  // console.log('newSnapshot', newSnapshot);\n  store.dispatch('addSnapshot', newSnapshot);\n}\n\n\nexport function delSnapshot(id: string, store: Store<AllStoreType>) {\n  const newSnapshot = cloneDeep(store.getters.currentSnapshot as Widget[]);\n  const activeInSnapshotIndex = newSnapshot.findIndex(item => item.id === id);\n  // console.log('newSnapshot', newSnapshot, activeInSnapshotIndex);\n  if (activeInSnapshotIndex > -1) {\n    newSnapshot.splice(activeInSnapshotIndex, 1);\n  }\n  // console.log('newSnapshot', newSnapshot);\n  store.dispatch('addSnapshot', newSnapshot);\n}\n\nexport function clearSnapshot(store: Store<AllStoreType>) {\n  store.dispatch('addSnapshot', []);\n}\n\n\nexport function saveSnapshot(store: Store<AllStoreType>) {\n  localStorage.setItem(storageKey, JSON.stringify(store.getters.currentSnapshot as Widget[]));\n}\n","import {defineComponent, reactive, watch, toRaw, ref} from \"vue\";\nimport {BaseStyle, Widget} from \"../../../store/types\";\nimport {properBase} from \"../../../uses/propertyBase\";\nimport {createLogger} from \"vuex\";\nimport {cloneDeep} from \"lodash\";\nimport {setSnapshot} from \"../../../uses/snapshop\";\n\nexport default defineComponent({\n  name: 'Base',\n  setup(props, { emit }) {\n    const store = properBase().store;\n    const activeWidget = properBase().widget;\n    const currentSnapshot = properBase().currentSnapshot;\n    const style = reactive<BaseStyle>({\n      fontSize: '',\n      color: '',\n      backgroundColor: '',\n      borderColor: '',\n      borderRadius: '',\n      textAlign: ''\n    });\n    const specialValue = reactive({\n      fontSize: 14,\n      borderRadius: 0\n    })\n    const opacity = ref(1);\n    watch(activeWidget, widget => {\n      // console.log('wat widget', widget?.style);\n      if (widget) {\n        setStyles(widget.style);\n        opacity.value = widget.widgetStyle.opacity || 1;\n      }\n    });\n    watch([specialValue, style], ([special, style]) => {\n      const cloneWidget = cloneDeep(activeWidget.value!);\n      const newWidget: Widget = {\n        ...cloneWidget,\n        style: {\n          ...cloneWidget.style,\n          ...toRaw(style),\n          fontSize: special.fontSize + 'px',\n          borderRadius: special.borderRadius + 'px',\n        }\n      }\n      setSnapshot(newWidget, store);\n    });\n\n    watch(opacity, value => {\n      const cloneWidget = cloneDeep(activeWidget.value!);\n      const newWidget: Widget = {\n        ...cloneWidget,\n        widgetStyle: { ...cloneWidget.widgetStyle, opacity: value }\n      }\n      setSnapshot(newWidget, store);\n    });\n\n    const setStyles = (newStyle: Partial<BaseStyle>) => {\n      // console.log('setStyles', newStyle);\n      Object.keys(style).forEach(key => {\n        const attr = key as keyof BaseStyle;\n        if (!Reflect.has(specialValue, attr)) {\n          style[attr] = newStyle[attr] || '';\n        } else {\n          specialValue.fontSize = newStyle.fontSize ? +newStyle.fontSize.slice(0, -2) : 14;\n          specialValue.borderRadius = newStyle.borderRadius ? +newStyle.borderRadius.slice(0, -2) : 14;\n        }\n      })\n    }\n\n    return () => {\n      return (\n        <div>\n          {\n            activeWidget.value ?\n              <el-form ref=\"form\" label-width=\"100px\">\n                <el-form-item label=\"字号：\">\n                  <el-input-number min={ 12 } v-model={ specialValue.fontSize } size=\"small\" />\n                </el-form-item>\n                <el-form-item label=\"圆角：\">\n                  <el-input-number min={ 0 } v-model={ specialValue.borderRadius } size=\"small\" />\n                </el-form-item>\n                <el-form-item label=\"对齐：\">\n                  <el-radio-group v-model={ style.textAlign }>\n                    <el-radio-button label=\"left\">左</el-radio-button>\n                    <el-radio-button label=\"center\">中</el-radio-button>\n                    <el-radio-button label=\"right\">右</el-radio-button>\n                  </el-radio-group>\n                </el-form-item>\n                <el-form-item label=\"字体颜色：\">\n                  <el-color-picker v-model={ style.color } />\n                </el-form-item>\n                <el-form-item label=\"背景颜色：\">\n                  <el-color-picker v-model={ style.backgroundColor } />\n                </el-form-item>\n                <el-form-item label=\"边框颜色：\">\n                  <el-color-picker v-model={ style.borderColor } />\n                </el-form-item>\n                <el-form-item label=\"透明度：\">\n                  <el-input-number min={0} max={1} step={0.1} step-strictly v-model={ opacity.value } size=\"small\" />\n                </el-form-item>\n              </el-form> :\n            <span>请选择组件</span>\n          }\n        </div>\n      );\n    }\n  }\n});\n","export function stopClick(event: MouseEvent) {\n  // event.preventDefault();\n  event.stopPropagation();\n}\n","import {defineComponent, h, resolveComponent} from \"vue\";\nimport {properBase} from \"../../../uses/propertyBase\";\n\nexport default defineComponent({\n  name: 'Custom',\n  setup(props) {\n    const activeWidget = properBase().widget;\n    return () => {\n      return (\n        <>\n          {\n            activeWidget.value?.specialPanel ? h(resolveComponent(activeWidget.value?.specialPanel)) : <span>请选择组件</span>\n          }\n        </>\n      );\n    }\n  }\n});\n","<template>\n  <div class=\"animate-panel\">\n    <template v-if=\"activeWidget\">\n      <div class=\"preview animate__animated\" ref=\"preview\">\n        Animate\n      </div>\n      <el-radio-group v-model=\"speed\" size=\"small\">\n        <el-radio-button label=\"slow\" />\n        <el-radio-button label=\"slower\" />\n        <el-radio-button label=\"fast\" />\n        <el-radio-button label=\"faster\" />\n      </el-radio-group>\n      <el-radio-group v-model=\"selected\">\n        <el-row>\n          <el-col class=\"col\" :span=\"12\" v-for=\"item of effects\" :key=\"item\">\n            <el-radio :label=\"item\">{{ item }}</el-radio>\n          </el-col>\n        </el-row>\n      </el-radio-group>\n    </template>\n    <span v-else>请选择组件</span>\n  </div>\n</template>\n<script lang=\"ts\">\nimport {defineComponent, ref, watch} from \"vue\";\nimport { properBase } from '../../../../uses/propertyBase';\nimport { Effects } from './effects';\nimport 'animate.css';\nimport './index.scss';\nimport {WidgetAnimateClass} from \"../../../../store/types\";\nimport {aniEmitter} from \"../../../Editor/bus\";\n\nexport default defineComponent({\n  name: 'Animate',\n  setup(props) {\n    const store = properBase().store;\n    const activeWidget = properBase().widget;\n    const effects = ref(Effects.filter(item => item.toLowerCase().indexOf('out') === -1));\n    const selected = ref('');\n    const speed = ref('');\n    const preview = ref<HTMLElement | null>(null);\n    let currentClass = '';\n    let speedClass = '';\n\n    const commitCls = (cls: Partial<WidgetAnimateClass>) => {\n      store.commit('editor/setAnimateClass', {\n        id: activeWidget.value!.id,\n        cls\n      });\n      aniEmitter.emit<void>('animate');\n    }\n\n    watch(selected, value => {\n      // console.log('wat selected', preview.value);\n      if (currentClass) {\n        preview.value!.classList.remove(currentClass);\n      }\n      currentClass = value;\n      preview.value!.classList.add(currentClass);\n      commitCls({ animate: currentClass });\n    });\n    watch(speed, value => {\n      // console.log('wat selected', preview.value);\n      if (speedClass) {\n        preview.value!.classList.remove(speedClass);\n      }\n      speedClass = value;\n      preview.value!.classList.add(speedClass);\n      commitCls({ speed: speedClass });\n    });\n    return {\n      effects,\n      selected,\n      speed,\n      activeWidget,\n      preview\n    }\n  }\n});\n</script>\n<style lang=\"scss\">\n  @import \"./index\";\n</style>\n","export const Effects = [\n  \"bounce\",\n  \"flash\",\n  \"pulse\",\n  \"rubberBand\",\n  \"shake\",\n  \"headShake\",\n  \"swing\",\n  \"tada\",\n  \"wobble\",\n  \"jello\",\n  \"bounceIn\",\n  \"bounceInDown\",\n  \"bounceInLeft\",\n  \"bounceInRight\",\n  \"bounceInUp\",\n  \"bounceOut\",\n  \"bounceOutDown\",\n  \"bounceOutLeft\",\n  \"bounceOutRight\",\n  \"bounceOutUp\",\n  \"fadeIn\",\n  \"fadeInDown\",\n  \"fadeInDownBig\",\n  \"fadeInLeft\",\n  \"fadeInLeftBig\",\n  \"fadeInRight\",\n  \"fadeInRightBig\",\n  \"fadeInUp\",\n  \"fadeInUpBig\",\n  \"fadeOut\",\n  \"fadeOutDown\",\n  \"fadeOutDownBig\",\n  \"fadeOutLeft\",\n  \"fadeOutLeftBig\",\n  \"fadeOutRight\",\n  \"fadeOutRightBig\",\n  \"fadeOutUp\",\n  \"fadeOutUpBig\",\n  \"lightSpeedIn\",\n  \"lightSpeedOut\",\n  \"flip\",\n  \"flipInX\",\n  \"flipInY\",\n  \"flipOutX\",\n  \"flipOutY\",\n  \"rotateIn\",\n  \"rotateInDownLeft\",\n  \"rotateInDownRight\",\n  \"rotateInUpLeft\",\n  \"rotateInUpRight\",\n  \"rotateOut\",\n  \"rotateOutDownLeft\",\n  \"rotateOutDownRight\",\n  \"rotateOutUpLeft\",\n  \"rotateOutUpRight\",\n  \"hinge\",\n  \"jackInTheBox\",\n  \"rollIn\",\n  \"rollOut\",\n  \"zoomOut\",\n  \"zoomOutDown\",\n  \"zoomOutLeft\",\n  \"zoomOutRight\",\n  \"zoomOutUp\",\n  \"zoomIn\",\n  \"zoomInDown\",\n  \"zoomInLeft\",\n  \"zoomInRight\",\n  \"zoomInUp\",\n  \"slideInDown\",\n  \"slideInLeft\",\n  \"slideInRight\",\n  \"slideInUp\",\n  \"slideOutDown\",\n  \"slideOutLeft\",\n  \"slideOutRight\",\n  \"slideOutUp\"\n];\n\n","import mitt from 'mitt';\n\nexport const emitter = mitt();\nexport const aniEmitter = mitt();\n","\nimport {defineComponent, ref, watch} from \"vue\";\nimport { properBase } from '../../../../uses/propertyBase';\nimport { Effects } from './effects';\nimport 'animate.css';\nimport './index.scss';\nimport {WidgetAnimateClass} from \"../../../../store/types\";\nimport {aniEmitter} from \"../../../Editor/bus\";\n\nexport default defineComponent({\n  name: 'Animate',\n  setup(props) {\n    const store = properBase().store;\n    const activeWidget = properBase().widget;\n    const effects = ref(Effects.filter(item => item.toLowerCase().indexOf('out') === -1));\n    const selected = ref('');\n    const speed = ref('');\n    const preview = ref<HTMLElement | null>(null);\n    let currentClass = '';\n    let speedClass = '';\n\n    const commitCls = (cls: Partial<WidgetAnimateClass>) => {\n      store.commit('editor/setAnimateClass', {\n        id: activeWidget.value!.id,\n        cls\n      });\n      aniEmitter.emit<void>('animate');\n    }\n\n    watch(selected, value => {\n      // console.log('wat selected', preview.value);\n      if (currentClass) {\n        preview.value!.classList.remove(currentClass);\n      }\n      currentClass = value;\n      preview.value!.classList.add(currentClass);\n      commitCls({ animate: currentClass });\n    });\n    watch(speed, value => {\n      // console.log('wat selected', preview.value);\n      if (speedClass) {\n        preview.value!.classList.remove(speedClass);\n      }\n      speedClass = value;\n      preview.value!.classList.add(speedClass);\n      commitCls({ speed: speedClass });\n    });\n    return {\n      effects,\n      selected,\n      speed,\n      activeWidget,\n      preview\n    }\n  }\n});\n","import { render } from \"./index.vue?vue&type=template&id=02179466\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=02179466&lang=scss\"\nscript.render = render\n\nexport default script","import {defineComponent, ref} from \"vue\";\nimport Base from \"./Base\";\nimport { stopClick } from \"../../../uses/stopClick\";\nimport Custom from \"./Custom\";\nimport Animate from \"./Animate/index.vue\";\n\nexport default defineComponent({\n  name: 'CustomPanel',\n  setup(props) {\n    return () => {\n      return (\n        <div class=\"panel-wrap\" onClick={ stopClick }>\n          <el-tabs modelValue=\"base\">\n            <el-tab-pane label=\"基本\" name=\"base\">\n              <Base />\n            </el-tab-pane>\n            <el-tab-pane label=\"定制\" name=\"custom\">\n              <Custom />\n            </el-tab-pane>\n            <el-tab-pane label=\"动画\" name=\"animate\">\n              <Animate />\n            </el-tab-pane>\n          </el-tabs>\n        </div>\n      );\n    }\n  }\n});\n","import {defineComponent} from \"vue\";\nimport {properBase} from \"../../uses/propertyBase\";\nimport {clearSnapshot, delSnapshot, saveSnapshot} from \"../../uses/snapshop\";\nimport { ElMessage } from 'element-plus'\n\nexport default defineComponent({\n  name: 'Header',\n  setup(props) {\n    const store = properBase().store;\n    const activeWidget = properBase().widget;\n    const currentSnapshot = properBase().currentSnapshot;\n\n    const changeIndex = (num: number) => {\n      store.commit('setCurrentIndex', store.state.currentIndex + num);\n    }\n\n    const handleDel = () => {\n      delSnapshot(activeWidget.value!.id!, store);\n    }\n    const handleClear = () => {\n      clearSnapshot(store);\n    }\n\n    const handleSave = () => {\n      saveSnapshot(store);\n      ElMessage.success({\n        message: '已保存',\n        type: 'success'\n      });\n    }\n    return () => {\n      return (\n        <div class=\"wrap\">\n          <h2>vue3-ts-drag</h2>\n          <el-button-group class=\"actions\">\n            <el-button onClick={ changeIndex.bind(null, -1) } disabled={ store.state.currentIndex === -1 }>后退</el-button>\n            <el-button onClick={ changeIndex.bind(null, 1) } disabled={ store.state.currentIndex === store.state.snapshots.length - 1 }>前进</el-button>\n            <el-button type=\"primary\" onClick={ handleSave }>保存</el-button>\n            <el-button type=\"warning\" onClick={ handleDel } disabled={ activeWidget.value === undefined }>删除</el-button>\n            <el-button type=\"danger\" onClick={ handleClear } disabled={ currentSnapshot.value.length === 0 }>清空</el-button>\n          </el-button-group>\n        </div>\n      );\n    }\n  }\n});\n","import {defineComponent} from \"vue\";\nimport Aside from \"./Aside\";\nimport './index.scss';\nimport CustomPanel from './CustomPanel';\nimport Header from \"./Header\";\n\nexport default defineComponent({\n  name: 'BasicLayout',\n  setup(props, { slots }) {\n    return () => {\n      return (\n        <el-container class=\"basic-layout\">\n          <el-header class=\"header\">\n            <Header />\n          </el-header>\n          <el-container>\n            <el-aside class=\"aside\" width=\"200px\">\n              <Aside />\n            </el-aside>\n            <el-main class=\"main\">{ slots.default!() }</el-main>\n            <el-aside class=\"aside\" width=\"300px\">\n              <CustomPanel />\n            </el-aside>\n          </el-container>\n        </el-container>\n      );\n    }\n  }\n})\n","import {Line, LineType, WidgetOffset} from \"../types\";\n\nexport const initLines: Line[] = [];\n['vl', 'vm', 'vr', 'ht', 'hm', 'hb'].forEach(type => {\n  initLines.push({ type: type as LineType, show: false });\n});\n\nexport function getCanvasOffset(rect: DOMRect): WidgetOffset {\n  const { width, height } = rect;\n  return {\n    vertical: [{\n      type: 'vl',\n      offset: 0\n    }, {\n      type: 'vm',\n      offset: width / 2\n    }, {\n      type: 'vr',\n      offset: width\n    }],\n    horizontal: [\n      {\n        type: 'ht',\n        offset: 0\n      },\n      {\n        type: 'hm',\n        offset: height / 2\n      },\n      {\n        type: 'hb',\n        offset: height\n      }\n    ]\n  }\n}\n","// 角度转弧度\nimport {MoveStartInfo} from \"./components/Editor/types\";\nimport {WidgetStyle} from \"./store/types\";\n\nfunction rotateToRadian(rotate: number): number {\n  return (rotate * Math.PI) / 180;\n}\n\n\n\nexport function sin(rotate: number) {\n  return Math.abs(Math.sin(rotateToRadian(rotate)));\n}\n\nexport function cos(rotate: number) {\n  return Math.abs(Math.cos(rotateToRadian(rotate)));\n}\n\n\n// 角度都转成0 ~ 360范围内\nexport function conversionRotateOneCircle(rotate: number): number {\n  return rotate <= 0\n    ? rotate + Math.ceil(Math.abs(rotate / 360)) * 360\n    : rotate - Math.floor(Math.abs(rotate / 360)) * 360;\n}\n\n// 角度属于哪个象限里\nexport function conversionRotateToQuadrant(rotate: number): number {\n  rotate = conversionRotateOneCircle(rotate);\n\n  const map: Map<boolean, 1 | 2 | 3 | 4> = new Map();\n  map.set(rotate >= 0 && rotate < 90, 1);\n  map.set(rotate >= 270 && rotate < 360, 4);\n  map.set(rotate >= 180 && rotate < 270, 3);\n  map.set(rotate >= 90 && rotate < 180, 2);\n\n  return ~~map.get(true)!;\n}\n\n\n// 求两点之间的中点坐标\nexport function getCenterPoint(p1: MoveStartInfo, p2: MoveStartInfo) {\n  return {\n    x: p1.x + ((p2.x - p1.x) / 2),\n    y: p1.y + ((p2.y - p1.y) / 2)\n  }\n}\n\n\n\n/**\n * 计算根据圆心旋转后的点的坐标\n * @param   {Object}  point   旋转前的点坐标\n * @param   {Object}  center  旋转中心\n * @param   {Int}     rotate  旋转的角度\n * @return  {Object}          旋转后的坐标\n */\nexport function getRotatedPoint(point: MoveStartInfo, center: MoveStartInfo, rotate: number): MoveStartInfo {\n  /**\n   * 旋转公式：\n   *  点a(x, y)\n   *  旋转中心c(x, y)\n   *  旋转后点n(x, y)\n   *  旋转角度θ                tan ??\n   * nx = cosθ * (ax - cx) - sinθ * (ay - cy) + cx\n   * ny = sinθ * (ax - cx) + cosθ * (ay - cy) + cy\n   */\n  return {\n    x: (point.x - center.x) * Math.cos(rotateToRadian(rotate)) - (point.y - center.y) * Math.sin(rotateToRadian(rotate)) + center.x,\n    y: (point.x - center.x) * Math.sin(rotateToRadian(rotate)) + (point.y - center.y) * Math.cos(rotateToRadian(rotate)) + center.y\n  }\n}\n\n\n/**\n * 获取旋转后的手柄坐标\n * @param  {Object} widgetStyle   形状的信息\n * @param  {Object} center   组件中心店\n * @param  {String} type 手柄名称\n * @return {Object}          旋转后的手柄坐标\n */\nexport function getPoint(widgetStyle: WidgetStyle, center: MoveStartInfo, type: string): MoveStartInfo {\n  let point: MoveStartInfo;\n  switch (type) {\n    case 'n':\n      point = {\n        x: widgetStyle.left + (widgetStyle.width / 2),\n        y: widgetStyle.top\n      }\n      break;\n    case 's':\n      point = {\n        x: widgetStyle.left + (widgetStyle.width / 2),\n        y: widgetStyle.top + widgetStyle.height\n      }\n      break;\n      case 'w':\n        point = {\n          x: widgetStyle.left,\n          y: widgetStyle.top + widgetStyle.height / 2\n        }\n      break;\n      case 'e':\n        point = {\n          x: widgetStyle.left + widgetStyle.width,\n          y: widgetStyle.top + widgetStyle.height / 2\n        }\n      break;\n      case 'nw':\n        point = {\n          x: widgetStyle.left,\n          y: widgetStyle.top\n        }\n      break;\n      case 'ne':\n        point = {\n          x: widgetStyle.left + widgetStyle.width,\n          y: widgetStyle.top\n        }\n      break;\n      case 'sw':\n        point = {\n          x: widgetStyle.left,\n          y: widgetStyle.top + widgetStyle.height\n        }\n      break;\n    default: // se\n      point = {\n        x: widgetStyle.left + widgetStyle.width,\n        y: widgetStyle.top+ widgetStyle.height\n      }\n      break;\n  }\n  return getRotatedPoint(point, center, widgetStyle.rotate);\n}\n","import {defineComponent, PropType, markRaw, ref, onMounted, nextTick} from \"vue\";\nimport {Widget, WidgetStyle} from \"../../../store/types\";\nimport {Line, singleOffset, WidgetMoveData, WidgetOffset} from \"../types\";\nimport {emitter} from \"../bus\";\nimport {Handler} from \"mitt\";\nimport {getCanvasOffset, initLines} from \"./utils\";\nimport {sin, cos} from \"../../../utils\";\n\nconst dis = 3;\n\nexport default defineComponent({\n  name: 'Lines',\n  props: {\n    widgets: {\n      type: Array as PropType<Widget[]>,\n      default: () => []\n    },\n    canvasRect: {\n      type: Object as PropType<DOMRect | null>,\n      default: null\n    }\n  },\n  setup(props) {\n    let canvasOffset: WidgetOffset;\n    onMounted(() => {\n      nextTick(() => {\n        // console.log('canvasRect', props.canvasRect);\n        if (props.canvasRect) {\n          canvasOffset = getCanvasOffset(props.canvasRect);\n        }\n      })\n    });\n\n    let offsetInfo = markRaw<WidgetOffset>({ vertical: [], horizontal: [] });\n    const movingWidgetSize = { width: 0, height: 0 };\n    const lines = ref<Line[]>(initLines);\n    /*watch(() => props.widgets, newVal => {\n      if (newVal.length) {\n        // saveWidgetsOffset();\n      }\n    }, { deep: true });*/\n\n\n    const handlePress = (id: string) => {\n      const otherWidgets = props.widgets.filter(item => item.id !== id);\n      if (otherWidgets.length) {\n        saveWidgetsOffset(otherWidgets);\n      }\n    }\n\n    const saveWidgetsOffset = (widgets: Widget[]) => {\n      offsetInfo = { vertical: [], horizontal: [] };\n      widgets.forEach(widget => {\n        const info = calculateWidgetOffset(widget.widgetStyle);\n        offsetInfo.vertical.push(...info.vertical);\n        offsetInfo.horizontal.push(...info.horizontal);\n      });\n    }\n\n    const handleMove = (data: WidgetMoveData) => {\n      const info = calculateWidgetOffset(data.style, true);\n      // console.log('handleMove info', movingWidgetSize);\n      info.vertical.forEach(v => {\n        const lineIndex = lines.value.findIndex(item => item.type === v.type);\n        const nearLine = offsetInfo.vertical.concat(canvasOffset.vertical).find(item => Math.abs(item.offset - v.offset) <= dis);\n        if (nearLine) {\n          lines.value[lineIndex].left = nearLine.offset;\n          lines.value[lineIndex].show = true;\n          const delta = data.style.rotate ? (data.style.width - movingWidgetSize.width) / 2 : 0;\n          let result = nearLine.offset - delta; // 不论delta正负都是对的\n          if (v.type === 'vm') {\n            result = nearLine.offset - movingWidgetSize.width / 2 - delta;\n          } else if (v.type === 'vr') {\n            result= nearLine.offset - movingWidgetSize.width - delta;\n          }\n          data.dom.style.left = result + 'px';\n        } else {\n          lines.value[lineIndex].show = false;\n        }\n      });\n      info.horizontal.forEach(h => {\n        const lineIndex = lines.value.findIndex(item => item.type === h.type);\n        const nearLine = offsetInfo.horizontal.concat(canvasOffset.horizontal).find(item => Math.abs(item.offset - h.offset) <= dis);\n        if (nearLine) {\n          lines.value[lineIndex].top = nearLine.offset;\n          lines.value[lineIndex].show = true;\n          const delta = data.style.rotate ? (movingWidgetSize.height - data.style.height) / 2 : 0;\n          let result = nearLine.offset + delta;\n          if (h.type === 'hm') {\n            result = nearLine.offset - movingWidgetSize.height / 2 + delta;\n          } else if (h.type === 'hb') {\n            result= nearLine.offset - movingWidgetSize.height + delta;\n          }\n          data.dom.style.top = result + 'px';\n        } else {\n          lines.value[lineIndex].show = false;\n        }\n      });\n    }\n\n    emitter.on<string>('press', handlePress as Handler<string>);\n    emitter.on<WidgetMoveData>('move', handleMove as Handler<WidgetMoveData>);\n    emitter.on<void>('up', () => {\n      // emitter.off<string>('press', handlePress as Handler<string>);\n      // emitter.off<WidgetStyle>('move', handleMove as Handler<WidgetStyle>);\n      lines.value.forEach(item => item.show = false);\n    });\n\n    const calculateWidgetOffset = (style: WidgetStyle, isMovingWidget = false): WidgetOffset => {\n      let vertical: singleOffset[] = [];\n      let horizontal: singleOffset[] = [];\n      if (isMovingWidget) {\n        movingWidgetSize.width = style.width;\n        movingWidgetSize.height = style.height;\n      }\n      if (style.rotate) {\n        const newWidth = style.width * cos(style.rotate) + style.height * sin(style.rotate);\n        const diffX = (style.width - newWidth) / 2; \t\t// 旋转后范围变小是正值，变大是负值\n        const vl = style.left + diffX;\n        // console.log('diffX', diffX);\n        vertical.push({\n          type: 'vl',\n          offset: vl\n        }, {\n          type: 'vm',\n          offset: vl + Math.abs(newWidth) / 2\n        }, {\n          type: 'vr',\n          offset: vl + newWidth\n        });\n\n        const newHeight = style.height * cos(style.rotate) + style.width * sin(style.rotate);\n        const diffY = (newHeight - style.height) / 2; \t\t// 始终是正\n        const ht = style.top - diffY;\n        horizontal.push({\n          type: 'ht',\n          offset: ht\n        }, {\n          type: 'hm',\n          offset: ht + newHeight / 2\n        }, {\n          type: 'hb',\n          offset: ht + newHeight\n        });\n        movingWidgetSize.width = newWidth;\n        // movingWidgetSize.height = sin(style.rotate) * style.width;\n        movingWidgetSize.height = newHeight;\n      } else {\n        const vl = style.left;\n        const ht = style.top;\n        vertical.push({\n          type: 'vl',\n          offset: vl\n        }, {\n          type: 'vm',\n          offset: vl + style.width / 2\n        }, {\n          type: 'vr',\n          offset: vl + style.width\n        });\n        horizontal.push({\n          type: 'ht',\n          offset: ht\n        }, {\n          type: 'hm',\n          offset: ht + style.height / 2\n        }, {\n          type: 'hb',\n          offset: ht + style.height\n        });\n      }\n      return { vertical, horizontal };\n    }\n\n    return () => {\n      return (\n        <>\n          {\n            lines.value.map(item => {\n              return <div\n                class={['line', { show: item.show, vertical: item.type.startsWith('v') }]}\n                style={{ top: item.top + 'px', left: item.left + 'px' }}>\n              </div>;\n            })\n          }\n        </>\n      );\n    }\n  }\n});\n","import {WidgetStyle} from \"../../store/types\";\n\nexport interface MoveStartInfo {\n  x: number;\n  y: number;\n}\n\nexport interface DragStartInfo extends MoveStartInfo {\n  left: number;\n  top: number;\n}\n\n\nexport enum Direct {\n  nw = '左上',\n  ne = '右上',\n  sw = '左下',\n  se = '右下',\n  w = '左',\n  e = '右',\n  n = '上',\n  s = '下'\n}\n\nexport interface DotInfo {\n  type: string;\n  trueType: string;\n  left: number;\n  top: number;\n}\n\nexport interface DotMouseDownInfo {\n  handlePoint: MoveStartInfo;\n  center: MoveStartInfo;\n  sPoint: MoveStartInfo;\n}\n\n\n/*\n  if (rotate) {\n\tconst newWIdth = width * Math.cos(r) + height * Math.sin(r);\n\tconst diffX = (width - newWIdth) / 2 \t\t// 旋转后范围变小是正值，变大是负值\n\tvl: position.left + diffX\n\tvm: vl + Math.abs(newWIdth) / 2\n\tvr: vl + newWIdth\n\n\n\n\n\tnewHeight = height * Math.cos(r) + width * Math.sin(r)\n\tconst diffY = (newHeight - height) / 2 \t\t// 始终是正\n\n\tht: position.top - diffY\n\thm: ht + newHeight / 2\n\thb: ht + newHeight\n} else {\n\tvl: position.left\n\tvm: position.left + style.width / 2\n\tvr: position.left + style.width\n\n\tht: position.top\n\thm: position.top + style.height / 2\n\thb: position.top + style.height\n}\n* */\n\nexport type LineType = 'vl' | 'vm' | 'vr' | 'ht' | 'hm' | 'hb';\n\nexport interface singleOffset {\n  type: LineType;\n  offset: number;\n}\n\nexport interface WidgetOffset {\n  vertical: singleOffset[];\n  horizontal: singleOffset[];\n}\n\n\nexport interface Line {\n  type: LineType;\n  show: boolean;\n  left?: number;\n  top?: number;\n}\n\nexport interface WidgetMoveData {\n  dom: HTMLElement;\n  style: WidgetStyle\n}\n","import {defineComponent, PropType} from \"vue\";\nimport {DotInfo, MoveStartInfo} from \"../types\";\nimport {useStore} from \"../../../store\";\n\nexport default defineComponent({\n  name: 'Dot',\n  props: {\n    info: {\n      type: Object as PropType<DotInfo>,\n      required: true\n    }\n  },\n  emits: ['down', 'move', 'up'],\n  setup(props, { emit }) {\n    const store = useStore();\n    const startInfo: MoveStartInfo = { x: 0, y: 0 };\n    const handleMousedown = (event: MouseEvent) => {\n      event.stopPropagation();\n      startInfo.x = event.clientX;\n      startInfo.y = event.clientY;\n      emit('down' );\n      toggleMoving(true);\n    }\n\n    const handleMouseMove = (event: MouseEvent) => {\n      event.preventDefault();\n      const { left, top } = store.state.editor.canvasRect!;\n      emit('move', { x: event.clientX - left, y: event.clientY - top });\n    }\n    const handleMouseUp = () => {\n      toggleMoving(false);\n      emit('up');\n    }\n\n\n    const toggleMoving = (movable: boolean) => {\n      if (movable) {\n        document.addEventListener('mousemove', handleMouseMove);\n        document.addEventListener('mouseup', handleMouseUp);\n      } else {\n        document.removeEventListener('mousemove', handleMouseMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      }\n    }\n\n    return () => {\n      return (\n        <div\n          class=\"dot\"\n          style={{ left: props.info.left + 'px', top: props.info.top + 'px', cursor: props.info.trueType + '-resize' }}\n          onMousedown={ handleMousedown }\n        >\n        </div>\n      );\n    }\n  }\n});\n","import {WidgetStyle} from \"../../store/types\";\nimport {Direct, DotMouseDownInfo, MoveStartInfo} from \"./types\";\nimport {getCenterPoint, getPoint, getRotatedPoint, sin} from \"../../utils\";\n\nexport interface MoveDiff {\n  diffX: number;\n  diffY: number;\n}\n\nfunction limitMinNum(num: number, limit: number): number {\n  return Math.max(num, limit);\n}\n\nfunction stretchN(dotMousedownInfo: DotMouseDownInfo, widgetStyle: WidgetStyle, currentPosition: MoveStartInfo, root: HTMLElement, callback: () => void) {\n  const { minSize, width } = widgetStyle;\n  const { sPoint, handlePoint } = dotMousedownInfo;\n  // console.log('handlePoint', handlePoint, currentPosition);\n\n  // step2：求currentPosition已handlePoint为中心，反向旋转rotate后的坐标\n  const rotatedCurrentPosition = getRotatedPoint(currentPosition, handlePoint, -widgetStyle.rotate);\n  // console.log('rotatedCurrentPosition', rotatedCurrentPosition);\n\n  // step3: 无旋转拉伸后的handlePoint以原handlePoint为中心，旋转rotate后的坐标\n  const rotatedTopMiddlePoint = getRotatedPoint({\n    x: handlePoint.x,\n    y: rotatedCurrentPosition.y\n  }, handlePoint, widgetStyle.rotate);\n  // console.log('rotatedTopMiddlePoint', rotatedTopMiddlePoint);\n\n  // 勾股定理\n  const newHeight = Math.sqrt(Math.pow(rotatedTopMiddlePoint.x - sPoint.x, 2) + Math.pow(rotatedTopMiddlePoint.y - sPoint.y, 2));\n  // console.log('newHeight', newHeight);\n\n  if (newHeight > minSize.height) {\n    const newCenter = {\n      x: rotatedTopMiddlePoint.x - (rotatedTopMiddlePoint.x - sPoint.x) / 2,\n      y: rotatedTopMiddlePoint.y + (sPoint.y - rotatedTopMiddlePoint.y) / 2\n    }\n    root.style.height = newHeight + 'px';\n    root.style.top = newCenter.y - (newHeight / 2) + 'px';\n    root.style.left = newCenter.x - (width / 2) + 'px';\n    callback();\n  }\n}\n\nfunction stretchE(dotMousedownInfo: DotMouseDownInfo, widgetStyle: WidgetStyle, currentPosition: MoveStartInfo, root: HTMLElement, callback: () => void) {\n  const { minSize, height } = widgetStyle;\n  const { sPoint, handlePoint } = dotMousedownInfo;\n\n  const rotatedCurrentPosition = getRotatedPoint(currentPosition, handlePoint, -widgetStyle.rotate);\n\n  const rotatedRightMiddlePoint = getRotatedPoint({\n    x: rotatedCurrentPosition.x,\n    y: handlePoint.y\n  }, handlePoint, widgetStyle.rotate);\n\n  const newWidth = Math.sqrt(Math.pow(rotatedRightMiddlePoint.x - sPoint.x, 2) + Math.pow(rotatedRightMiddlePoint.y - sPoint.y, 2));\n\n  if (newWidth > minSize.width) {\n    const newCenter = {\n      x: rotatedRightMiddlePoint.x - (rotatedRightMiddlePoint.x - sPoint.x) / 2,\n      y: rotatedRightMiddlePoint.y + (sPoint.y - rotatedRightMiddlePoint.y) / 2\n    }\n    root.style.width = newWidth + 'px';\n    root.style.top = newCenter.y - (height / 2) + 'px';\n    root.style.left = newCenter.x - (newWidth / 2) + 'px';\n    callback();\n  }\n}\n\n\nfunction stretchS(dotMousedownInfo: DotMouseDownInfo, widgetStyle: WidgetStyle, currentPosition: MoveStartInfo, root: HTMLElement, callback: () => void) {\n  const { minSize, width } = widgetStyle;\n  const { sPoint, handlePoint } = dotMousedownInfo;\n\n  const rotatedCurrentPosition = getRotatedPoint(currentPosition, handlePoint, -widgetStyle.rotate);\n\n  const rotatedBottomMiddlePoint = getRotatedPoint({\n    x: handlePoint.x,\n    y: rotatedCurrentPosition.y\n  }, handlePoint, widgetStyle.rotate);\n\n  const newHeight = Math.sqrt(Math.pow(rotatedBottomMiddlePoint.x - sPoint.x, 2) + Math.pow(rotatedBottomMiddlePoint.y - sPoint.y, 2));\n\n  if (newHeight > minSize.height) {\n    const newCenter = {\n      x: rotatedBottomMiddlePoint.x - (rotatedBottomMiddlePoint.x - sPoint.x) / 2,\n      y: rotatedBottomMiddlePoint.y + (sPoint.y - rotatedBottomMiddlePoint.y) / 2\n    }\n    root.style.height = newHeight + 'px';\n    root.style.top = newCenter.y - (newHeight / 2) + 'px';\n    root.style.left = newCenter.x - (width / 2) + 'px';\n    callback();\n  }\n}\n\n\nfunction stretchW(dotMousedownInfo: DotMouseDownInfo, widgetStyle: WidgetStyle, currentPosition: MoveStartInfo, root: HTMLElement, callback: () => void) {\n  const { minSize, height } = widgetStyle;\n  const { sPoint, handlePoint } = dotMousedownInfo;\n\n  const rotatedCurrentPosition = getRotatedPoint(currentPosition, handlePoint, -widgetStyle.rotate);\n\n  const rotatedLeftMiddlePoint = getRotatedPoint({\n    x: rotatedCurrentPosition.x,\n    y: handlePoint.y\n  }, handlePoint, widgetStyle.rotate);\n\n  const newWidth = Math.sqrt(Math.pow(rotatedLeftMiddlePoint.x - sPoint.x, 2) + Math.pow(rotatedLeftMiddlePoint.y - sPoint.y, 2));\n\n  if (newWidth > minSize.width) {\n    const newCenter = {\n      x: rotatedLeftMiddlePoint.x - (rotatedLeftMiddlePoint.x - sPoint.x) / 2,\n      y: rotatedLeftMiddlePoint.y + (sPoint.y - rotatedLeftMiddlePoint.y) / 2\n    }\n    root.style.width = newWidth + 'px';\n    root.style.top = newCenter.y - (height / 2) + 'px';\n    root.style.left = newCenter.x - (newWidth / 2) + 'px';\n    callback();\n  }\n}\n\n\nfunction stretchNW(dotMousedownInfo: DotMouseDownInfo, widgetStyle: WidgetStyle, currentPosition: MoveStartInfo, root: HTMLElement, callback: () => void) {\n  const { minSize } = widgetStyle;\n  const { sPoint } = dotMousedownInfo;\n  const newCenterPoint = getCenterPoint(currentPosition, sPoint);\n  const newTopLeftPoint = getRotatedPoint(currentPosition, newCenterPoint, -widgetStyle.rotate)\n  const newBottomRightPoint = getRotatedPoint(sPoint, newCenterPoint, -widgetStyle.rotate)\n\n  const newWidth = newBottomRightPoint.x - newTopLeftPoint.x\n  const newHeight = newBottomRightPoint.y - newTopLeftPoint.y\n  if (newWidth > minSize.width && newHeight > minSize.height) {\n    root.style.width = newWidth + 'px';\n    root.style.height = newHeight + 'px';\n    root.style.left = newTopLeftPoint.x + 'px';\n    root.style.top = newTopLeftPoint.y + 'px';\n    callback();\n  }\n}\n\nfunction stretchNE(dotMousedownInfo: DotMouseDownInfo, widgetStyle: WidgetStyle, currentPosition: MoveStartInfo, root: HTMLElement, callback: () => void) {\n  const { minSize } = widgetStyle;\n  const { sPoint } = dotMousedownInfo;\n  const newCenterPoint = getCenterPoint(currentPosition, sPoint);\n\n  const newTopRightPoint = getRotatedPoint(currentPosition, newCenterPoint, -widgetStyle.rotate)\n  const newBottomLeftPoint = getRotatedPoint(sPoint, newCenterPoint, -widgetStyle.rotate)\n\n  const newWidth = newTopRightPoint.x - newBottomLeftPoint.x\n  const newHeight = newBottomLeftPoint.y - newTopRightPoint.y\n  if (newWidth > minSize.width && newHeight > minSize.height) {\n    root.style.width = newWidth + 'px';\n    root.style.height = newHeight + 'px';\n    root.style.left = newBottomLeftPoint.x + 'px';\n    root.style.top = newTopRightPoint.y + 'px';\n    callback();\n  }\n}\n\n\nfunction stretchSE(dotMousedownInfo: DotMouseDownInfo, widgetStyle: WidgetStyle, currentPosition: MoveStartInfo, root: HTMLElement, callback: () => void) {\n  const { minSize } = widgetStyle;\n  const { sPoint } = dotMousedownInfo;\n  const newCenterPoint = getCenterPoint(currentPosition, sPoint);\n\n  const newTopLeftPoint = getRotatedPoint(sPoint, newCenterPoint, -widgetStyle.rotate)\n  const newBottomRightPoint = getRotatedPoint(currentPosition, newCenterPoint, -widgetStyle.rotate)\n\n  const newWidth = newBottomRightPoint.x - newTopLeftPoint.x\n  const newHeight = newBottomRightPoint.y - newTopLeftPoint.y\n\n  if (newWidth > minSize.width && newHeight > minSize.height) {\n    root.style.width = newWidth + 'px';\n    root.style.height = newHeight + 'px';\n    root.style.left = newTopLeftPoint.x + 'px';\n    root.style.top = newTopLeftPoint.y + 'px';\n    callback();\n  }\n}\n\n\nfunction stretchSW(dotMousedownInfo: DotMouseDownInfo, widgetStyle: WidgetStyle, currentPosition: MoveStartInfo, root: HTMLElement, callback: () => void) {\n  const { minSize } = widgetStyle;\n  const { sPoint } = dotMousedownInfo;\n  const newCenterPoint = getCenterPoint(currentPosition, sPoint);\n\n  const newTopRightPoint = getRotatedPoint(sPoint, newCenterPoint, -widgetStyle.rotate)\n  const newBottomLeftPoint = getRotatedPoint(currentPosition, newCenterPoint, -widgetStyle.rotate)\n\n  const newWidth = newTopRightPoint.x - newBottomLeftPoint.x\n  const newHeight = newBottomLeftPoint.y - newTopRightPoint.y\n  if (newWidth > minSize.width && newHeight > minSize.height) {\n    root.style.width = newWidth + 'px';\n    root.style.height = newHeight + 'px';\n    root.style.left = newBottomLeftPoint.x + 'px';\n    root.style.top = newTopRightPoint.y + 'px';\n    callback();\n  }\n}\n\n\n\n\nexport const stretchStrategy: { [key: string]: (dotMousedownInfo: DotMouseDownInfo, widgetStyle: WidgetStyle, currentPosition: MoveStartInfo, root: HTMLElement, callback: () => void) => void } = {\n  n: stretchN,\n  e: stretchE,\n  s: stretchS,\n  w: stretchW,\n  nw: stretchNW,\n  ne: stretchNE,\n  se: stretchSE,\n  sw: stretchSW\n}\n","import {conversionRotateOneCircle, conversionRotateToQuadrant} from \"../../../utils\";\nimport {DotInfo} from \"../types\";\n\nconst quadrantDirect = new Map<number, string>([\n  [1, 'ne'],\n  [2, 'nw'],\n  [3, 'sw'],\n  [4, 'se']\n]);\n\nconst onCoordinate = new Map<number, string>([\n  [0, 'e'],\n  [90, 'n'],\n  [180, 'w'],\n  [270, 's']\n]);\n\nconst sx = new Map<string, number>([\n  ['nw', 135],\n  ['n', 90],\n  ['ne', 45],\n  ['e', 0],\n  ['se', 315],\n  ['s', 270],\n  ['sw', 225],\n  ['w', 180]\n]);\nconst getTrueType = (type: string, rotate: number): string => {\n  rotate = conversionRotateOneCircle(rotate);\n  const newRotate = conversionRotateOneCircle(sx.get(type)! - rotate);\n  let result = '';\n  if (newRotate % 90 === 0) {\n    // console.log('newRotate', newRotate);\n    result = onCoordinate.get(newRotate)!;\n  } else {\n    const whichQuadrantDirect = conversionRotateToQuadrant(newRotate);\n    result = quadrantDirect.get(whichQuadrantDirect)!;\n  }\n  // console.log('result', result);\n  return result;\n}\n\nexport function calculateDotInfo(type: string, value: string, width: number, height: number, rotate: number): DotInfo {\n  let left = 0;\n  let top = 0;\n  const trueType = getTrueType(type, rotate);\n  // console.log('trueType', trueType);\n  switch (value) {\n    case '右上':\n      left = width;\n      top = 0;\n      break;\n    case '左下':\n      left = 0;\n      top = height;\n      break;\n    case '右下':\n      left = width;\n      top = height;\n      break;\n    case '左':\n      left = 0;\n      top = height / 2;\n      break;\n    case '右':\n      left = width;\n      top = height / 2;\n      break;\n    case '上':\n      left = width / 2;\n      top = 0;\n      break;\n    case '下':\n      left = width / 2;\n      top = height;\n      break;\n  }\n  return { type, trueType, left, top };\n}\n","import {defineComponent, PropType} from \"vue\";\nimport {useStore} from \"../../store\";\nimport {MoveStartInfo} from \"./types\";\nimport {WidgetStyle} from \"../../store/types\";\n\nexport default defineComponent({\n  name: 'RotateDot',\n  props: {\n    widgetStyle: {\n      type: Object as PropType<WidgetStyle>,\n      required: true\n    }\n  },\n  emits: ['down', 'move', 'up'],\n  setup(props, { emit }) {\n    const store = useStore();\n    let originCenter: MoveStartInfo;\n    const { left, top, width, height } = store.state.editor.canvasRect!;\n    const handleMousedown = (event: MouseEvent) => {\n      event.stopPropagation();\n      originCenter = {\n        x: props.widgetStyle.left + (props.widgetStyle.width / 2),\n        y: props.widgetStyle.top + (props.widgetStyle.height / 2)\n      }\n      // emit('down' );\n      toggleMoving(true);\n    }\n\n    const handleMouseMove = (event: MouseEvent) => {\n      event.preventDefault();\n      const currentX = event.clientX - left;\n      const currentY = event.clientY - top;\n      const a = Math.abs(currentX - originCenter.x);\n      const b = Math.abs(currentY - originCenter.y);\n      // const c = Math.sqrt(a * a + b * b);\n      let rotate = Math.atan2(b, a) * 180 / Math.PI;\n      // console.log('rotate :>> ', rotate);\n\n      // 第一象限\n      if (currentX >= originCenter.x && currentY <= originCenter.y) {\n        rotate = 90 - rotate;\n      }\n      // 第二象限\n      else if (currentX <= originCenter.x && currentY <= originCenter.y) {\n        rotate = 270 + rotate;\n      }\n      // 第三象限\n      else if (currentX <= originCenter.x && currentY >= originCenter.y) {\n        rotate = 270 - rotate;\n      }\n      // 第四象限\n      else if(currentX >= originCenter.x && currentY >= originCenter.y) {\n        rotate = 90 + rotate;\n      }\n\n      // const result = rotate === 360 ? rotate : rotate;\n      emit('move', rotate);\n    }\n    const handleMouseUp = () => {\n      toggleMoving(false);\n      emit('up');\n    }\n\n\n    const toggleMoving = (movable: boolean) => {\n      if (movable) {\n        document.addEventListener('mousemove', handleMouseMove);\n        document.addEventListener('mouseup', handleMouseUp);\n      } else {\n        document.removeEventListener('mousemove', handleMouseMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      }\n    }\n    return () => {\n      return (<i class=\"el-icon-refresh-right rotate\" onMousedown={ handleMousedown }></i>);\n    }\n  }\n});\n","import {defineComponent, onMounted, ref, PropType, computed, h, watch, reactive} from \"vue\";\nimport {Widget, WidgetAnimateClass} from \"../../store/types\";\nimport {useStore} from \"../../store\";\nimport Dot from './Dot/index';\nimport {Direct, DotInfo, DotMouseDownInfo, DragStartInfo, MoveStartInfo, WidgetMoveData} from \"./types\";\nimport {aniEmitter, emitter} from \"./bus\";\nimport {stretchStrategy} from \"./stretch\";\nimport {calculateDotInfo} from \"./Dot/dot\";\nimport {getPoint} from \"../../utils\";\nimport RotateDot from './RotateDot';\nimport {stopClick} from \"../../uses/stopClick\";\nimport {properBase} from \"../../uses/propertyBase\";\nimport { cloneDeep } from 'lodash';\nimport {setSnapshot} from \"../../uses/snapshop\";\n\nexport default defineComponent({\n  name: 'WidgetBox',\n  props: {\n    info: {\n      type: Object as PropType<Widget>,\n      required: true\n    }\n  },\n  setup(props, { slots }) {\n    const root = ref<HTMLElement | null>(null);\n    let startInfo: DragStartInfo | null = null;\n    const dots = ref<DotInfo[]>([]);\n    const store = properBase().store;\n    const currentSnapshot = properBase().currentSnapshot;\n    const activeWidget = properBase().widget;\n    let moving = false;\n    const isActive = computed(() => activeWidget.value?.id === props.info.id);\n    const setActive = () => {\n      store.commit('editor/setActivateWidgetId', props.info.id);\n      generateDots();\n    }\n\n    const toggleMoving = (movable: boolean) => {\n      if (movable) {\n        document.addEventListener('mousemove', handleMouseMove);\n        document.addEventListener('mouseup', handleMouseUp);\n      } else {\n        document.removeEventListener('mousemove', handleMouseMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      }\n    }\n\n    const handleMousedown = (event: MouseEvent) => {\n      // console.log('event', event.target);\n      event.preventDefault();\n      startInfo = {\n        x: event.clientX,\n        y: event.clientY,\n        left: root.value!.offsetLeft, // left和top第一次等于props.info.position\n        top: root.value!.offsetTop\n      };\n      root.value!.style.zIndex = '2';\n      emitter.emit<string>('press', props.info.id);\n      setActive();\n      toggleMoving(true);\n    }\n\n    const handleMouseMove = (event: MouseEvent) => {\n      event.preventDefault();\n      moving = true;\n      const diffX = event.clientX - startInfo!.x;\n      const diffY = event.clientY - startInfo!.y;\n      const { left, top } = calculate(diffX, diffY);\n      root.value!.style.top = top + 'px';\n      root.value!.style.left = left + 'px';\n      emitter.emit<WidgetMoveData>('move', {\n        dom: root.value!,\n        style: { ...props.info.widgetStyle, left, top }\n      });\n    }\n    const handleMouseUp = () => {\n      toggleMoving(false);\n      if (moving) {\n        root.value!.style.zIndex = '1';\n        const cloneWidget = cloneDeep(props.info);\n        const newWidget: Widget = {\n          ...cloneWidget,\n          widgetStyle: { ...cloneWidget.widgetStyle,  left: root.value!.offsetLeft, top: root.value!.offsetTop }\n        }\n        setSnapshot(newWidget, store);\n        moving = false;\n        emitter.emit<void>('up');\n      }\n    }\n\n    const calculate = (diffX: number, diffY: number): { left: number; top: number } => {\n      let newLeft = startInfo!.left + diffX;\n      let newTop = startInfo!.top + diffY;\n      return {\n        left: newLeft,\n        top: newTop\n      };\n    }\n\n    let dotMousedownInfo: DotMouseDownInfo;\n\n    const handleDotDown = (type: string) => {\n      // step1: handlePoint旋转后的坐标\n      const { widgetStyle } = props.info;\n      const center = {\n        x: widgetStyle.left + (widgetStyle.width / 2),\n        y: widgetStyle.top + (widgetStyle.height / 2)\n      }\n      const handlePoint = getPoint(widgetStyle, center, type);\n     /* const sPoint = {\n        x: center.x + Math.abs(handlePoint.x - center.x) * (handlePoint.x < center.x ? 1 : -1),\n        y: center.y + Math.abs(handlePoint.y - center.y) * (handlePoint.y < center.y ? 1 : -1)\n      }*/\n      const sPoint = {\n        x: center.x - (handlePoint.x - center.x),\n        y: center.y - (handlePoint.y - center.y)\n      }\n      dotMousedownInfo = { handlePoint, center, sPoint }\n      // console.log('dotMousedownInfo', dotMousedownInfo);\n    }\n\n    const handleDotMove = (type: string, position: MoveStartInfo) => {\n      stretchStrategy[type](dotMousedownInfo, props.info.widgetStyle, position, root.value!, () => generateDots());\n    }\n\n    const handleDotUp = () => {\n      const cloneWidget = cloneDeep(props.info);\n      const newWidget: Widget = {\n        ...cloneWidget,\n        widgetStyle: {\n          ...cloneWidget.widgetStyle,\n          width: root.value!.clientWidth,\n          height: root.value!.clientHeight,\n          top: root.value!.offsetTop,\n          left: root.value!.offsetLeft\n        }\n      }\n      setSnapshot(newWidget, store);\n    }\n\n\n    const generateDots = () => {\n      const width = root.value!.clientWidth;\n      const height = root.value!.clientHeight;\n      dots.value = [];\n      Object.entries(Direct).forEach(([type, value]) => {\n        dots.value.push(calculateDotInfo(type, value, width, height, props.info.widgetStyle.rotate));\n      });\n    }\n\n    const renderDots = () => {\n      return dots.value.map(item => {\n        return h(Dot, {\n          info: item,\n          onDown: handleDotDown.bind(null, item.type),\n          onMove: handleDotMove.bind(null, item.type),\n          onUp: handleDotUp\n        });\n      });\n    }\n\n    const handleRotateDotMove = (rotate: number) => {\n      // console.log('handleRotateDotMove', rotate);\n      root.value!.style.transform = 'rotate(' + rotate + 'deg)';\n      root.value!.setAttribute('data-rotate', rotate.toString());\n    }\n\n    const handleRotateDotUp = () => {\n      const cloneWidget = cloneDeep(props.info);\n      const newWidget: Widget = {\n        ...cloneWidget,\n        widgetStyle: { ...cloneWidget.widgetStyle, rotate: +(root.value!.dataset.rotate || 0) }\n      }\n      setSnapshot(newWidget, store);\n    }\n\n    // watch(() => props.info.animateClass, cls => {\n    //   setCls(cls);\n    // });\n\n    aniEmitter.on<void>('animate', () => {\n      if (isActive.value) {\n        setCls(props.info.animateClass);\n      }\n    });\n\n    const setCls = (cls: Partial<WidgetAnimateClass>) => {\n      [cls.animate, cls.speed].filter(Boolean).forEach(item => {\n        root.value!.classList.add('animate__' + item!);\n      });\n    }\n\n    const refresh = () => {\n      root.value!.style.left = props.info.widgetStyle.left + 'px';\n      root.value!.style.top = props.info.widgetStyle.top + 'px';\n      root.value!.style.width = props.info.widgetStyle.width + 'px';\n      root.value!.style.height = props.info.widgetStyle.height + 'px';\n      root.value!.style.transform = `rotate(${props.info.widgetStyle.rotate}deg)`;\n      root.value!.style.opacity = props.info.widgetStyle.opacity.toString();\n      root.value!.style.zIndex = '1';\n      // setCls(props.info.animateClass);\n    }\n\n    watch(() => props.info, info => {\n      // console.log('wat info', info);\n      refresh();\n    });\n\n    onMounted(() => {\n      refresh();\n      setCls(props.info.animateClass);\n      root.value!.addEventListener('animationend', function() {\n        const active = isActive.value ? ' active' : '';\n        this.className = 'widget animate__animated' + active;\n      });\n    });\n\n    return () => {\n      return (\n        <div class={{\n          widget: true,\n          animate__animated: true,\n          active: isActive.value\n        }} ref={ root } onClick={ stopClick } onMousedown={ handleMousedown }>\n          <RotateDot\n            widgetStyle={ props.info.widgetStyle }\n            v-show={ isActive.value }\n            // @ts-ignore\n            onMove={ handleRotateDotMove }\n            onUp={ handleRotateDotUp }\n          />\n          { isActive.value ? renderDots() : null }\n          { slots.default!() }\n        </div>\n      );\n    }\n  }\n})\n","import { Ref, unref } from 'vue';\n\nfunction isWindow(val: unknown): val is Window {\n  return val === window;\n}\n\nexport const useRect = (elementRef: (Element | Window) | Ref<Element | Window | undefined>) => {\n  const element = unref(elementRef);\n\n  if (isWindow(element)) {\n    const width = element.innerWidth;\n    const height = element.innerHeight;\n\n    return {\n      top: 0,\n      left: 0,\n      right: width,\n      bottom: height,\n      width,\n      height,\n    };\n  }\n\n  if (element && element.getBoundingClientRect) {\n    return element.getBoundingClientRect();\n  }\n\n  return {\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    width: 0,\n    height: 0,\n  };\n};\n","import {defineComponent, h, resolveComponent, ref, onMounted, watch, computed} from \"vue\";\nimport Lines from \"./Lines\";\nimport WidgetBox from './Widget';\nimport './index.scss';\nimport {useStore} from '../../store';\nimport {WidgetList} from \"../../store/widgets\";\nimport { uniqueId, cloneDeep } from 'lodash';\nimport {useRect} from \"../../uses/rect\";\nimport {Widget} from \"../../store/types\";\nimport {properBase} from \"../../uses/propertyBase\";\n\nexport default defineComponent({\n  name: 'Editor',\n  setup(props) {\n    const store = properBase().store;\n    const currentSnapshot = properBase().currentSnapshot;\n    const widgets = computed(() => store.state.editor.widgets);\n\n    watch(currentSnapshot, value => {\n      store.commit('editor/resetWidgets', value);\n    });\n    \n    const renderWidgets = () => {\n      // console.log('renderWidgets', currentSnapshot.value);\n      return widgets.value.length ? widgets.value.map(item => {\n        return <WidgetBox info={ item } >\n          {\n            item.name === '按钮' ?\n              h(resolveComponent(item.component), { ...item.props, style: item.style }, () => item.label) :\n              h(resolveComponent(item.component), { ...item.props, style: item.style }, () => item.label)\n          }\n        </WidgetBox>;\n      }) : null;\n    }\n    // ondrag - 元素正在拖动时触发  ondragend - 用户完成元素拖动后触发\n    // widget.widgetStyle.left = event.offsetX;\n    // widget.widgetStyle.top = event.offsetY;\n    const handleDragOver = (event: DragEvent) => {\n      event.preventDefault();\n      event.dataTransfer!.dropEffect = 'copy';\n    }\n\n    const handleDrop = (event: DragEvent) => {\n      event.preventDefault();\n      const target = event.target as Element;\n      if (target?.classList.contains('canvas')) {\n        const index = event.dataTransfer?.getData('index'); // string | undefined\n        if (index) {\n          const widget = cloneDeep(WidgetList[+index]);\n          // console.log('drop', widget);\n          widget.widgetStyle.left = event.offsetX;\n          widget.widgetStyle.top = event.offsetY;\n          // widget.widgetStyle.rotate = 0;\n          widget.id = generateUUID();\n          store.dispatch('addSnapshot', currentSnapshot.value.concat(widget));\n          // store.commit('editor/addWidget', cloneDeep(widget));\n        }\n      }\n      if (store.state.editor.activeWidgetId) {\n        store.commit('editor/setActivateWidgetId', '');\n      }\n    }\n\n\n\n    const canvas = ref<HTMLElement>();\n    onMounted(() => {\n      if (currentSnapshot.value.length) {\n        store.commit('editor/resetWidgets', currentSnapshot.value);\n      }\n      store.commit('editor/setCanvasRect', useRect(canvas.value!));\n      // console.log('canvas', canvas.value!.getBoundingClientRect());\n    })\n\n    return () => {\n      return (\n        <div class=\"editor-container\">\n          <div class=\"editor-box\">\n            <div ref={ canvas } class=\"canvas\" onDragover={ handleDragOver } onDrop={ handleDrop }>\n              { renderWidgets() }\n              <Lines canvasRect={ store.state.editor.canvasRect } widgets={ widgets.value } />\n            </div>\n          </div>\n        </div>\n      );\n    }\n  }\n});\n\n\nfunction generateUUID(){\n  let d = new Date().getTime();\n  const uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    const r = (d + Math.random() * 16) % 16 | 0;\n    d = Math.floor(d/16);\n    return (c=='x' ? r : (r&0x7|0x8)).toString(16);\n  });\n  return uuid;\n}\n","\nimport {defineComponent, onMounted, ref} from 'vue';\nimport BasicLayout from \"../components/BasicLayout\";\nimport Editor from '../components/Editor';\nimport {useStore} from \"../store\";\nimport {storageKey} from \"../main\";\n\nexport default defineComponent({\n  name: 'Home',\n  components: { BasicLayout, Editor },\n  setup() {\n    const root = ref<HTMLElement | null>(null);\n    const store = useStore();\n    const records = localStorage.getItem(storageKey);\n    if (records) {\n      store.dispatch('addSnapshot', JSON.parse(records));\n    }\n    onMounted(() => {\n      if (root.value) {\n        root.value.addEventListener('click', (event: MouseEvent) => {\n          if (store.state.editor.activeWidgetId) {\n            store.commit('editor/setActivateWidgetId', '');\n          }\n        });\n      }\n    });\n    return {\n      root\n    }\n  }\n});\n","import { render } from \"./Home.vue?vue&type=template&id=1c057756\"\nimport script from \"./Home.vue?vue&type=script&lang=ts\"\nexport * from \"./Home.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import { createRouter, createWebHashHistory, RouteRecordRaw } from 'vue-router'\nimport Home from '../views/Home.vue'\n\nconst routes: Array<RouteRecordRaw> = [\n  {\n    path: '/home',\n    name: 'Home',\n    component: Home\n  },\n  {\n    path: '',\n    redirect: '/home'\n  },\n  {\n    path: '/:pathMatch(.*)*',\n    redirect: '/home'\n  }\n]\n\nconst router = createRouter({\n  history: createWebHashHistory(),\n  routes\n})\n\nexport default router\n","import { App } from 'vue';\nimport { ElRow, ElCol, ElCheckbox, ElRadio, ElRadioGroup, ElRadioButton, ElColorPicker, ElDropdown, ElDropdownMenu, ElDropdownItem, ElButton, ElButtonGroup, ElContainer, ElHeader, ElFooter, ElAside, ElMain, ElCard, ElSpace, ElTabs, ElTabPane, ElForm, ElFormItem, ElInput, ElInputNumber } from 'element-plus';\nimport lang from 'element-plus/lib/locale/lang/zh-cn';\nimport locale from 'element-plus/lib/locale';\nimport 'dayjs/locale/zh-cn';\n\nlocale.use(lang);\n\nconst components = [\n  ElButton,\n  ElButtonGroup,\n  ElContainer,\n  ElHeader,\n  ElFooter,\n  ElAside,\n  ElMain,\n  ElCard,\n  ElSpace,\n  ElTabs,\n  ElTabPane,\n  ElForm,\n  ElFormItem,\n  ElInput,\n  ElInputNumber,\n  ElRadio,\n  ElRadioGroup,\n  ElRadioButton,\n  ElColorPicker,\n  ElCheckbox,\n  ElRow,\n  ElCol\n]\n\nexport default (app: App) => {\n  components.forEach(item => app.component(item.name,item));\n}\n","import {defineComponent, reactive, ref, toRaw, watch} from \"vue\";\nimport './index.scss';\nimport {properBase} from \"../../../../../uses/propertyBase\";\nimport {BaseStyle, Widget} from \"../../../../../store/types\";\nimport {cloneDeep} from \"lodash\";\nimport {setSnapshot} from \"../../../../../uses/snapshop\";\n\ninterface ButtonProps {\n  disable: boolean;\n  loading: boolean;\n  type: string;\n}\n\nexport default defineComponent({\n  name: 'ButtonProperty',\n  setup(props) {\n    const store = properBase().store;\n    const activeWidget = properBase().widget;\n    const label = ref('按钮');\n    const propValues = reactive<ButtonProps>({\n      disable: false,\n      loading: false,\n      type: 'primary'\n    });\n\n    const setProps = (props: ButtonProps) => {\n      // console.log('setProps', props);\n      Object.keys(propValues).forEach(key => {\n        const prop = key as keyof ButtonProps;\n        if (props[prop]) {\n          // @ts-ignore\n          propValues[prop] = props[prop];\n        }\n      })\n    }\n\n\n    const setStatus = (widget: Widget | undefined) => {\n      if (widget) {\n        label.value = widget.label;\n        setProps(widget.props);\n      }\n    }\n\n\n\n    setStatus(activeWidget.value);\n    watch(activeWidget, widget => {\n      // console.log('wat bbbb widget', widget?.label);\n      setStatus(widget);\n    });\n\n    watch(label, label => {\n      const cloneWidget = cloneDeep(activeWidget.value!);\n      const newWidget: Widget = {\n        ...cloneWidget,\n        label\n      }\n      setSnapshot(newWidget, store);\n    });\n\n    watch(propValues, props => {\n      const cloneWidget = cloneDeep(activeWidget.value!);\n      const newWidget: Widget = {\n        ...cloneWidget,\n        props: { ...cloneWidget.props, ...props }\n      }\n      setSnapshot(newWidget, store);\n    });\n\n    return () => {\n      return (\n        <div class=\"btn-panel\">\n         <div class=\"item\"> 文字：<el-input v-model={ label.value } /></div>\n         <div class=\"item\"><el-checkbox v-model={ propValues.disable }>禁用</el-checkbox></div>\n         <div class=\"item\"><el-checkbox v-model={ propValues.loading }>加载中</el-checkbox></div>\n          <div class=\"item\">\n            类型：\n            <el-radio-group size=\"small\" v-model={ propValues.type }>\n              <el-radio-button label=\"primary\" />\n              <el-radio-button label=\"success\" />\n              <el-radio-button label=\"warning\" />\n              <el-radio-button label=\"danger\" />\n              <el-radio-button label=\"info\" />\n              <el-radio-button label=\"text\" />\n            </el-radio-group>\n          </div>\n        </div>\n      );\n    }\n  }\n});\n","import {defineComponent, reactive, ref, toRaw, watch} from \"vue\";\nimport './index.scss';\nimport {properBase} from \"../../../../../uses/propertyBase\";\nimport {BaseStyle, Widget} from \"../../../../../store/types\";\nimport {cloneDeep} from \"lodash\";\nimport {setSnapshot} from \"../../../../../uses/snapshop\";\n\ninterface CardProps {\n  shadow: string;\n  header: string;\n}\n\nexport default defineComponent({\n  name: 'CardProperty',\n  setup(props) {\n    const store = properBase().store;\n    const activeWidget = properBase().widget;\n    const label = ref('');\n    const propValues = reactive<CardProps>({\n      shadow: 'hover',\n      header: '标题'\n    });\n\n    const setProps = (props: CardProps) => {\n      Object.keys(propValues).forEach(key => {\n        const prop = key as keyof CardProps;\n        if (props[prop]) {\n          // @ts-ignore\n          propValues[prop] = props[prop];\n        }\n      })\n    }\n\n\n    const setStatus = (widget: Widget | undefined) => {\n      if (widget) {\n        label.value = widget.label;\n        setProps(widget.props);\n      }\n    }\n\n\n\n    setStatus(activeWidget.value);\n    watch(activeWidget, widget => {\n      setStatus(widget);\n    });\n\n    watch(label, value => {\n      const cloneWidget = cloneDeep(activeWidget.value!);\n      const newWidget: Widget = {\n        ...cloneWidget,\n        label: value\n      }\n      setSnapshot(newWidget, store);\n    });\n\n    watch(propValues, props => {\n      const cloneWidget = cloneDeep(activeWidget.value!);\n      const newWidget: Widget = {\n        ...cloneWidget,\n        props: { ...cloneWidget.props, ...props }\n      }\n      setSnapshot(newWidget, store);\n    });\n\n    return () => {\n      return (\n        <div class=\"card-panel\">\n         <div class=\"item\"> 标题：<el-input v-model={ propValues.header } /></div>\n          <div class=\"item\"> 内容：<el-input type=\"textarea\" v-model={ label.value } /></div>\n          <div class=\"item\">\n            阴影：\n            <el-radio-group size=\"small\" v-model={ propValues.shadow }>\n              <el-radio-button label=\"always \" />\n              <el-radio-button label=\"hover\" />\n              <el-radio-button label=\"never\" />\n            </el-radio-group>\n          </div>\n        </div>\n      );\n    }\n  }\n});\n","import { App } from 'vue';\nimport ButtonProperty from \"./ButtonProperty\";\nimport CardProperty from \"./CardProperty\";\n\nconst components = [\n  ButtonProperty,\n  CardProperty\n]\n\nexport default (app: App) => {\n  components.forEach(item => app.component(item.name, item));\n}\n","import { createApp } from 'vue';\nimport App from './App.vue';\nimport router from './router';\nimport {key, store} from './store';\nimport installElementPlus from './plugins';\nimport installSpecialPanel from './components/BasicLayout/CustomPanel/Specials';\nimport './assets/styles/index.scss';\nexport const storageKey = 'record';\nconst app = createApp(App);\ninstallElementPlus(app);\ninstallSpecialPanel(app);\napp.use(store, key).use(router).mount('#root');\n"],"sourceRoot":""}